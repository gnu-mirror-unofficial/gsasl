stages:
 - build
 - test
 - deploy

Debian:
  image: debian:latest
  stage: build
  before_script:
    - apt-get update -qq
    - env DEBIAN_FRONTEND=noninteractive apt-get install -y -qq git autoconf automake libtool gettext cvs make texinfo texlive texlive-generic-recommended texlive-extra-utils texlive-font-utils help2man gtk-doc-tools valgrind dia libgnutls28-dev gengetopt gperf
  script:
    - make autoreconf
    - ./configure --enable-gcc-warnings --disable-silent-rules --enable-gtk-doc --enable-gtk-doc-pdf
    - make V=1
    - make syntax-check
    - make check V=1 || (find . -name test-suite.log -exec cat {} +; exit 1)
    - make dist
    - sha224sum gsasl-*.tar.gz
  artifacts:
    expire_in: 2 weeks
    paths:
      - gsasl-*.tar.gz
